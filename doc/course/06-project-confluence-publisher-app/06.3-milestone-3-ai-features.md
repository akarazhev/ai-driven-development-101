# M3: AI-Assisted Content Generation

Add AI features to help users create better content: generate page content improvements and automatic description for images.

## Learning objectives

- Integrate AI into your application
- Implement content content improvement generation
- Add automatic description generation
- Create UI for AI features
- Evaluate AI output quality

## Prerequisites

- M2 completed (core flows working)
- AI API access (OpenAI, Anthropic, etc.) or use Cursor's AI
- Understanding of AI prompting (from previous chapters)

## Acceptance criteria

- [ ] Can generate page content improvements using AI
- [ ] Can generate description for images
- [ ] AI features integrated into UI
- [ ] AI output is validated and safe
- [ ] Evaluation notes documented

## Step-by-step guide

### Step 1: Set up AI integration

**Choose AI provider**:

- OpenAI API
- Anthropic Claude API
- Use Cursor's AI (for development)
- Other LLM API

**Configure API access**:

```text
Role: Backend developer
Task: Set up AI API integration
Constraints:
- Use environment variables for API keys
- Create AI service/client
- Handle API errors gracefully
- Include rate limiting
- Never log API keys
Inputs: [AI provider choice]
Output format: AI service setup
Evaluation: Can call AI API, errors handled, keys secure
```

### Step 2: Implement content improvement generation

**Backend endpoint**:

```text
Role: Backend developer
Task: Implement AI content improvement generation endpoint
Constraints:
- Endpoint: POST /api/ai/content improvements
- Accept: { message: string }
- Prompt: Generate 3 content improvements (max 200 chars each)
- Return: { content improvements: string[] }
- Validate: input length, output format
- Handle: API errors, rate limits
Inputs: [AI service, prompt template]
Output format: Content improvement generation endpoint + tests
Evaluation: Generates content improvements, handles errors, validates output
```

**Prompt template**:

```text
Role: Social copywriter
Task: Produce 3 short content improvements (max 200 chars) for the following message
Constraints:
- Respect platform tone guidelines
- Avoid sensitive claims
- Include 1 relevant hashtag when appropriate
- Keep each content improvement unique
Inputs: [original message]
Output format: JSON array of strings
Evaluation: Content is clear, non-duplicative, and policy-safe
```

### Step 3: Implement description generation

**Backend endpoint**:

```text
Role: Backend developer
Task: Implement AI description generation endpoint
Constraints:
- Endpoint: POST /api/ai/alt-text
- Accept: { description: string }
- Prompt: Generate concise description (8-20 words)
- Return: { alt_text: string }
- Validate: output length, quality
- Handle: API errors
Inputs: [AI service, prompt template]
Output format: Description generation endpoint + tests
Evaluation: Generates description, handles errors, validates output
```

**Prompt template**:

```text
Role: Accessibility assistant
Task: Write concise, descriptive description for an image
Constraints:
- 1 sentence, 8-20 words
- Avoid speculation
- Be accurate and helpful
- No marketing language
Inputs: [brief image description]
Output: Plain sentence
Evaluation: Helpful and accurate without extra language
```

### Step 4: Add AI features to UI

**Content improvement generation in compose**:

```text
Role: Frontend developer
Task: Add content improvement generation to compose page
Constraints:
- Button: "Generate content improvements"
- Show: loading state
- Display: generated content improvements
- Allow: selecting content improvement to use
- Handle: errors gracefully
- Use [your framework] patterns
Inputs: [Compose page, API client]
Output format: Updated compose component
Evaluation: Can generate content improvements, select one, handle errors
```

**Description generation**:

```text
Role: Frontend developer
Task: Add description generation to attachment upload
Constraints:
- Button: "Generate description" for each image
- Show: loading state
- Fill: description field with generated text
- Allow: editing generated text
- Handle: errors gracefully
- Use [your framework] patterns
Inputs: [Attachment upload component, API client]
Output format: Updated upload component
Evaluation: Can generate description, edit it, handle errors
```

### Step 5: Add safety checks

**Content validation**:

```text
Role: Backend developer
Task: Add safety checks for AI-generated content
Constraints:
- Validate: length limits
- Check: for inappropriate content (basic)
- Sanitize: output before returning
- Log: validation failures
- Return: safe content only
Inputs: [AI endpoints]
Output format: Validation middleware/service
Evaluation: Filters unsafe content, logs issues
```

### Step 6: Evaluate AI output

**Create evaluation document**:

```text
Role: QA engineer
Task: Evaluate AI output quality
Constraints:
- Test: content improvement generation with sample inputs
- Test: description generation with sample images
- Document: what works well, what doesn't
- Note: prompt improvements needed
- Record: example outputs
Inputs: [AI endpoints, test cases]
Output format: Evaluation notes document
Evaluation: Clear assessment of AI quality
```

**Test cases**:

- Short messages (< 50 chars)
- Long messages (> 200 chars)
- Messages with hashtags
- Messages with mentions
- Various image types

## Testing

### Test content improvement generation

```text
Role: Test engineer
Task: Write tests for content improvement generation
Constraints:
- Test: successful generation
- Test: input validation
- Test: error handling
- Test: output format
- Use [your testing framework]
Inputs: [Content improvement endpoint]
Output format: Test file
Evaluation: All tests pass
```

### Test description generation

```text
Role: Test engineer
Task: Write tests for description generation
Constraints:
- Test: successful generation
- Test: input validation
- Test: output length
- Test: error handling
- Use [your testing framework]
Inputs: [Description endpoint]
Output format: Test file
Evaluation: All tests pass
```

### Test safety checks

```text
Role: Test engineer
Task: Write tests for safety validation
Constraints:
- Test: length validation
- Test: content filtering
- Test: sanitization
- Use [your testing framework]
Inputs: [Validation service]
Output format: Test file
Evaluation: All tests pass
```

## Evaluation checklist

Evaluate AI output quality:

- [ ] Content improvements are unique and useful
- [ ] Description is accurate and helpful
- [ ] Output follows length constraints
- [ ] Safety checks work
- [ ] Error handling is robust
- [ ] UI integration works smoothly
- [ ] Performance is acceptable

## Troubleshooting

### Issue: AI API errors

**Solutions**:

- Check API key is valid
- Verify rate limits
- Review API error messages
- Implement retry logic
- Check network connectivity

### Issue: Poor AI output quality

**Solutions**:

- Refine prompt templates
- Add more constraints
- Provide better examples
- Try different models
- Adjust temperature settings

### Issue: Slow AI responses

**Solutions**:

- Add loading states
- Implement caching
- Use faster models
- Optimize prompts
- Consider async processing

## Next steps

Once M3 is complete, proceed to **[M4: Polishing and Deployment](./06.4-milestone-4-polishing.md)**

## Deliverables

- AI content improvement generation working
- AI description generation working
- AI features in UI
- Safety checks implemented
- Evaluation notes documented
- Tests passing

